#
# New Relic Java Agent Configuration
# For detailed configuration options, see:
# https://docs.newrelic.com/docs/agents/java-agent/configuration/java-agent-configuration-config-file
#

common: &default_settings
  # ============================== LICENSE KEY ===============================
  # You must specify the license key associated with your New Relic account.
  # For example, if your license key is 12345 use this:
  # license_key: '12345'
  license_key: 'f4dea96fee48ba7af33e4382ca8831c5FFFFNRAL'

  # Agent Enabled
  # Use this setting to disable the agent instead of removing it from the startup command.
  # Default is true.
  agent_enabled: true

  # Set the name of your application as you'd like it to show up in the New Relic UI.
  # If enable_auto_app_naming is false, the agent reports all data to this application.
  # Otherwise, the agent reports only background tasks (transactions for non-web applications)
  # to this application. To report data to more than one application
  # (useful for rollup reporting), separate the application names with ";".
  # For example, to report data to "My Application" and "My Application 2" use this:
  # app_name: My Application;My Application 2
  # This setting is required. Up to 3 different application names can be specified.
  # The first application name must be the primary name.
  app_name: Demo Spring Boot APM App

  # To enable high security, set this property to true. When in high
  # security mode, the agent will use SSL and obfuscated SQL. Additionally,
  # request parameters and message parameters will not be sent to New Relic.
  high_security: false

  # Set to true to enable support for auto app naming.
  # The name of each web app is detected automatically
  # and the agent reports data separately for each one.
  # This provides a finer-grained performance breakdown for
  # web apps in New Relic.
  # Default is false.
  enable_auto_app_naming: false

  # Set to true to enable component-based transaction naming.
  # Set to false to use the URI of a web request as the name of the transaction.
  # Default is true.
  enable_auto_transaction_naming: true

  # The agent communicates with New Relic via https by default.
  # If you want to communicate with newrelic via proxy, then you may use one of:
  # proxy_host, proxy_port (defaults: none and 8080)
  # proxy_user, proxy_password (default: none)
  # proxy_scheme (default: https)

  # Limits the number of lines to capture for each stack trace.
  # Default is 30
  max_stack_trace_lines: 30

  # Provides the ability to configure the attributes sent to New Relic.
  attributes:
    # When true, attributes will be sent to New Relic. The default is true.
    enabled: true

    # A comma separated list of attribute keys whose values should be sent to New Relic.
    include:

    # A comma separated list of attribute keys whose values should not be sent to New Relic.
    exclude:

  # Transaction tracer captures deep information about slow transactions and
  # sends this to the New Relic service once a minute. Included in the
  # transaction is the exact call sequence of the transactions including any SQL statements
  # issued.
  transaction_tracer:

    # Transaction tracer is enabled by default. Set this to false to turn it off.
    # This feature is not available to Lite accounts and is automatically disabled.
    # Default is true.
    enabled: true

    # Threshold in seconds for when to collect a transaction trace. When the
    # response time of a controller action exceeds this threshold, a transaction
    # trace will be recorded and sent to New Relic. Valid values are any float
    # value, or (default) "apdex_f", which will use the threshold for the
    # "Frustrated" Apdex level (greater than four times the apdex_t value).
    # Default is apdex_f.
    transaction_threshold: apdex_f

    # When transaction tracer is on, SQL statements can optionally be recorded.
    # The recorder has three modes, "off" which sends no SQL, "raw" which sends
    # the SQL statement in its original form, and "obfuscated" which strips out
    # numeric and string literals.
    # Default is obfuscated.
    record_sql: obfuscated

    # Set this to true to log SQL statements instead of recording them.
    # SQL is logged using the record_sql mode.
    # Default is false.
    log_sql: false

    # Threshold in seconds for when to collect stack trace for a SQL call. In
    # other words, when SQL statements exceed this threshold, then capture and
    # send to New Relic the current stack trace. This is helpful for pinpointing
    # where long SQL calls originate from.
    # Default is 0.5 seconds.
    stack_trace_threshold: 0.5

    # Determines whether the agent will capture query plans for slow SQL queries.
    # Only supported in MySQL and PostgreSQL.
    # Default is true.
    explain_enabled: true

    # Threshold for query execution time below which query plans will not be captured.
    # Relevant only when `explain_enabled` is true.
    # Default is 0.5 seconds.
    explain_threshold: 0.5

    # Use this setting to control the variety of transaction traces.
    # The higher the setting, the greater the variety.
    # Set this to 0 to always report the slowest transaction trace.
    # Default is 20.
    top_n: 20

  # Error collector captures information about uncaught exceptions and sends them to New Relic for viewing.
  error_collector:

    # This property enables the collection of errors. If the property is not set or the
    # property is set to false, then errors will not be collected.
    # Default is true.
    enabled: true

    # Use this property to exclude specific exceptions from being reported as errors
    # by providing a comma separated list of full class names.
    # The default is to exclude akka.actor.ActorKilledException. If you want to override
    # this, you must provide any new value as an empty list is ignored.
    ignore_errors: akka.actor.ActorKilledException

    # Use this property to exclude specific http status codes from being reported as errors
    # by providing a comma separated list of status codes.
    # The default is to exclude 404s. If you want to override
    # this, you must provide any new value as an empty list is ignored.
    ignore_status_codes: 404

  # Transaction Events are used for histograms and percentiles. Unaggregated data is collected
  # for each web transaction and sent to the server on harvest.
  transaction_events:

    # Set to false to disable transaction events.
    # Default is true.
    enabled: true

    # Events are collected up to the configured amount. Afterwards, events are sampled to
    # maintain an even distribution across the harvest cycle.
    # Default is 2000. Setting to 0 will disable.
    max_samples_stored: 2000

  # Distributed tracing lets you see the path that a request takes through your distributed system.
  distributed_tracing:

    # Set to true to enable distributed tracing.
    # Default is true.
    enabled: true

  # Cross Application Tracing adds request and response headers to external calls using supported
  # HTTP libraries to provide better performance data when calling applications that use New Relic agents.
  cross_application_tracer:

    # Set to true to enable cross application tracing.
    # Default is true.
    enabled: true

  # Thread profiler measures wall clock time, CPU time, and method call counts
  # in your application's threads as they run.
  # This feature is not available to Lite accounts and is automatically disabled.
  thread_profiler:

    # Set to false to disable the thread profiler.
    # Default is true.
    enabled: true

  # New Relic Real User Monitoring gives you insight into the performance real users are
  # experiencing with your website. This is accomplished by measuring the time it takes for
  # your users' browsers to download and render your web pages by injecting a small amount
  # of JavaScript code into the header and footer of each page.
  browser_monitoring:

    # By default the agent automatically inserts API calls in compiled JSPs to
    # inject the monitoring JavaScript into web pages. Not all rendering engines are supported.
    # See https://docs.newrelic.com/docs/agents/java-agent/instrumentation/page-load-timing-java#auto_instrumentation
    # for a list of supported frameworks.
    # Set this attribute to false to turn off this behavior.
    auto_instrument: true

  # Application Logging
  application_logging:

    # Enable all New Relic logging features for this application.
    # Default is true.
    enabled: true

    # Forwarding
    forwarding:

      # Sets the maximum number of log records to send to New Relic every 60 seconds.
      # Default is 10000. Setting to 0 will disable.
      max_samples_stored: 10000

      # If true, the agent captures log records emitted by your application and forwards them to New Relic.
      # Default is true.
      enabled: true

    # Metrics
    metrics:

      # If true, the agent captures metrics related to logging for your application.
      # Default is true.
      enabled: true

    # Local Decorating
    local_decorating:

      # If true, the agent decorates logs with metadata to link to entities, hosts, traces, and spans.
      # Requires a logging framework that supports decorating.
      # Default is false.
      enabled: false

# Environment specific settings are in this section.
# You can use the environment to override the default settings.
# For example, to change the app_name setting.
# Use -Dnewrelic.environment=<environment> on the Java startup command line
# to set the environment.
# The default environment is production.

# NOTE if your application has other named environments, you should
# provide configuration settings for those environments here.

development:
  <<: *default_settings
  app_name: Demo Spring Boot APM App (Development)

test:
  <<: *default_settings
  app_name: Demo Spring Boot APM App (Test)

production:
  <<: *default_settings

staging:
  <<: *default_settings
  app_name: Demo Spring Boot APM App (Staging)
  host: staging-collector.newrelic.com
  event_ingest_uri: https://staging-insights-collector.newrelic.com/v1/accounts/events
  metric_ingest_uri: https://staging-metric-api.newrelic.com/metric/v1
  log_level: FINEST
